<!DOCTYPE html>
<html>
<head>
    <title>Contract Admin</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .container { max-width: 600px; margin: 0 auto; }
        .card { background: #f5f5f5; padding: 20px; border-radius: 8px; margin: 20px 0; }
        input { width: 100%; padding: 10px; margin: 10px 0; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .info { background: #d4edda; padding: 10px; border-radius: 4px; }
        .error { background: #f8d7da; padding: 10px; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Contract Address Manager</h1>
        
        <div class="card">
            <h3>Current Contract</h3>
            <div id="currentContract" class="info">Loading...</div>
        </div>
        
        <div class="card">
            <h3>Update Contract Address</h3>
            <input type="text" id="newAddress" placeholder="0x..." style="font-family: monospace;">
            <button onclick="updateContract()">Update Contract Address</button>
            <div id="updateResult"></div>
        </div>
        
        <div class="card">
            <h3>Quick Actions</h3>
            <button onclick="openBackend()">Open Backend</button>
            <button onclick="openFrontend()">Open Frontend</button>
            <button onclick="restartBackend()">Restart Backend</button>
        </div>
    </div>

    <script>
        async function loadCurrentContract() {
            try {
                const response = await fetch('http://localhost:3001/config');
                const config = await response.json();
                
                document.getElementById('currentContract').innerHTML = `
                    <strong>Address:</strong> ${config.contractAddress}<br>
                    <strong>Network:</strong> ${config.network}<br>
                    <strong>Deployed:</strong> ${new Date(config.deployedAt).toLocaleString()}
                `;
            } catch (error) {
                document.getElementById('currentContract').innerHTML = 
                    '‚ùå Could not load contract info. Is the backend running?';
            }
        }
        
        async function updateContract() {
            const newAddress = document.getElementById('newAddress').value.trim();
            const resultDiv = document.getElementById('updateResult');
            
            if (!newAddress.startsWith('0x') || newAddress.length !== 42) {
                resultDiv.innerHTML = '<div class="error">‚ùå Invalid contract address format</div>';
                return;
            }
            
            try {
                // Note: This would need a proper API endpoint in your backend
                // For now, this is a frontend interface - the actual update
                // would be done through the scripts
                resultDiv.innerHTML = `<div class="info">
                    ‚ö†Ô∏è Contract update would be processed here.<br>
                    For now, use: <code>npm run contract:update ${newAddress}</code>
                </div>`;
                
                // Clear input
                document.getElementById('newAddress').value = '';
                
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
            }
        }
        
        function openBackend() {
            window.open('http://localhost:3001', '_blank');
        }
        
        function openFrontend() {
            window.open('frontend-test.html', '_blank');
        }
        
        function restartBackend() {
            alert('Backend restart would happen here. Currently, you need to manually stop and restart the backend.');
        }
        
        // Load current contract on page load
        loadCurrentContract();
    </script>
</body>
</html>